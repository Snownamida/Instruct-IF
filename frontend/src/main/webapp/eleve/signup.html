<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscription élève</title>
    <link rel="stylesheet" href="signup.css">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>INSCRIPTION ÉLÈVE</h1>
            <a href="../index.html"> <button type="button" class="retour">Retour</button></a>
        </div>
        <h2>Informations personnelles</h2>
        <div class="form-group">
            <label for="nom">NOM </label>
            <input id="champ-nom" type="text" placeholder="ex : DUFAUT" />
        </div>
        <div class="form-group">
            <label for="prenom">Prenom </label>
            <input id="champ-prenom" type="text" placeholder="ex : Marc" />
        </div>
        <div class="form-group date-group">
            <label for="jour">Né(e) le </label>
            <input id="champ-jour" type="text" placeholder="JJ" />
            <input id="champ-mois" type="text" placeholder="MM" />
            <input id="champ-annee" type="text" placeholder="AAAA" />
        </div>
        <h2>Cursus et établissement</h2>
        <div class="form-group">
            <label for="code">Code établissement </label>
            <input id="champ-code" type="text" placeholder="ex : 0691664J" />
        </div>
        <div class="form-group">
            <label for="classe">Classe </label>
            <select id="champ-classe">
                <option value="0">Terminale</option>
                <option value="1">Première</option>
                <option value="2">Seconde</option>
                <option value="3">3ème</option>
                <option value="4">4ème</option>
                <option value="5">5ème</option>
                <option value="6">6ème</option>
            </select>
        </div>
        <h2>Accès au compte</h2>
        <div class="form-group">
            <label for="mail">Adresse mail </label>
            <input id="champ-mail" type="text" placeholder="ex : dufaut.marc@gmail.com" />
        </div>
        <div class="form-group">
            <label for="password">Mot de passe </label>
            <input id="champ-password" type="password" placeholder="********" />
        </div>
        <div class="form-group">
            <button type="button" class="btn" onclick="signup()">M'inscrire</button>
        </div>
    </div>

    <script>
        function signup() { // Fonction appelée lors du clic sur le bouton m'inscrire
            // Récupération de la valeur des champs du formulaire
            const champNom = $('#champ-nom').val();
            const champPrenom = $('#champ-prenom').val();
            const champJour = $('#champ-jour').val();
            const champMois = $('#champ-mois').val();
            const champAnnee = $('#champ-annee').val();
            const champCode = $('#champ-code').val();
            const champClasse = $('#champ-classe').val();
            const champMail = $('#champ-mail').val();
            const champPassword = $('#champ-password').val();
            // Appel AJAX
            $.ajax({
                url: '../ActionServlet',
                method: 'POST',
                data: {
                    todo: 'inscrire',
                    lastName: champNom,
                    firstName: champPrenom,
                    birthday: champJour + '/' + champMois + '/' + champAnnee,
                    codeEtablissement: champCode,
                    class: champClasse,
                    mail: champMail,
                    password: champPassword
                },
                dataType: 'json'
            })
                .done(function (response) { // Fonction appelée en cas d'appel AJAX réussi
                    console.log('Response', response); // LOG dans Console Javascript
                })
                .fail(function (error) { // Fonction appelée en cas d'erreur lors de l'appel AJAX
                    console.log('Error', error); // LOG dans Console Javascript
                    alert("Erreur lors de l'appel AJAX");
                })
                .always(function () { // Fonction toujours appelée
                });
        }
    </script>
</body>

</html>